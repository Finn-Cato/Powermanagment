{
  "id": "no.powerguard",
  "version": "0.6.2",
  "compatibility": ">=8.0.0",
  "sdk": 3,
  "brandColor": "#1E4A72",
  "name": {
    "en": "Power Guard",
    "no": "Power Guard"
  },
  "description": {
    "en": "Keep your home within its power limit — automatically",
    "no": "Hold hjemmet innenfor effektgrensen — automatisk"
  },
  "category": [
    "energy"
  ],
  "tags": {
    "en": [
      "power",
      "energy",
      "limit",
      "HAN",
      "frient",
      "EV",
      "charger"
    ],
    "no": [
      "strøm",
      "effekt",
      "grense",
      "HAN",
      "frient",
      "elbil",
      "lader"
    ]
  },
  "images": {
    "small": "/assets/images/small.png",
    "large": "/assets/images/large.png",
    "xlarge": "/assets/images/xlarge.png"
  },
  "author": {
    "name": "Power Guard",
    "email": "powerguard@finnlyden.no"
  },
  "support": "https://github.com/Finn-Cato/Powermanagment/issues",
  "source": "https://github.com/Finn-Cato/Powermanagment",
  "permissions": [
    "homey:manager:api"
  ],
  "drivers": [
    {
      "id": "ev-charger",
      "name": {
        "en": "EV Charger",
        "no": "Elbillader"
      },
      "class": "other",
      "connectivity": [],
      "capabilities": [
        "onoff",
        "measure_power"
      ],
      "images": {
        "small": "/drivers/ev-charger/assets/small.png",
        "large": "/drivers/ev-charger/assets/large.png",
        "xlarge": "/drivers/ev-charger/assets/xlarge.png"
      },
      "pair": [
        {
          "id": "list_devices",
          "template": "list_devices",
          "navigation": {
            "next": "add_devices"
          }
        },
        {
          "id": "add_devices",
          "template": "add_devices"
        }
      ]
    },
    {
      "id": "power-guard",
      "name": {
        "en": "Power Guard",
        "no": "Power Guard"
      },
      "class": "other",
      "connectivity": [],
      "capabilities": [
        "onoff",
        "measure_power"
      ],
      "images": {
        "small": "/drivers/power-guard/assets/small.png",
        "large": "/drivers/power-guard/assets/large.png",
        "xlarge": "/drivers/power-guard/assets/xlarge.png"
      },
      "pair": [
        {
          "id": "list_devices",
          "template": "list_devices",
          "navigation": {
            "next": "add_devices"
          }
        },
        {
          "id": "add_devices",
          "template": "add_devices"
        }
      ]
    }
  ],
  "api": {
    "getAllData": {
      "method": "GET",
      "path": "/all"
    },
    "getStatus": {
      "method": "GET",
      "path": "/status"
    },
    "getSettings": {
      "method": "GET",
      "path": "/settings-all"
    },
    "getDevices": {
      "method": "GET",
      "path": "/devices"
    },
    "setSettings": {
      "method": "POST",
      "path": "/settings"
    },
    "setPriorityList": {
      "method": "POST",
      "path": "/priority-list"
    },
    "getDiagnostic": {
      "method": "GET",
      "path": "/diagnostic"
    },
    "getCacheStatus": {
      "method": "GET",
      "path": "/cache-status"
    },
    "refreshDeviceCache": {
      "method": "POST",
      "path": "/device-cache-refresh"
    },
    "getPowerConsumption": {
      "method": "GET",
      "path": "/powerConsumption"
    },
    "getDebugLog": {
      "method": "GET",
      "path": "/debugLog"
    },
    "getFloorHeaters": {
      "method": "GET",
      "path": "/floorHeaters"
    },
    "controlFloorHeater": {
      "method": "POST",
      "path": "/floorHeater-control"
    },
    "testCharger": {
      "method": "POST",
      "path": "/test-charger"
    },
    "applyCircuitLimits": {
      "method": "POST",
      "path": "/apply-circuit-limits"
    },
    "getChargerLimits": {
      "method": "GET",
      "path": "/get-charger-limits"
    },
    "getMeterDevices": {
      "method": "GET",
      "path": "/meter-devices"
    },
    "getHanDiagnostic": {
      "method": "GET",
      "path": "/han-diagnostic"
    },
    "setMeterDevice": {
      "method": "POST",
      "path": "/set-meter-device"
    },
    "getAppLog": {
      "method": "GET",
      "path": "/app-log"
    },
    "getFirmwareInfo": {
      "method": "GET",
      "path": "/firmwareInfo"
    }
  },
  "flow": {
    "triggers": [
      {
        "id": "power_limit_exceeded",
        "title": {
          "en": "Power limit exceeded",
          "no": "Effektgrense overskredet"
        },
        "tokens": [
          {
            "name": "power",
            "type": "number",
            "title": {
              "en": "Power (W)",
              "no": "Effekt (W)"
            },
            "example": 5200
          }
        ]
      },
      {
        "id": "mitigation_applied",
        "title": {
          "en": "Mitigation applied to a device",
          "no": "Tiltak iverksatt på en enhet"
        },
        "tokens": [
          {
            "name": "device_name",
            "type": "string",
            "title": {
              "en": "Device name",
              "no": "Enhetsnavn"
            },
            "example": "Floor heater"
          },
          {
            "name": "action",
            "type": "string",
            "title": {
              "en": "Action",
              "no": "Handling"
            },
            "example": "onoff"
          }
        ]
      },
      {
        "id": "mitigation_cleared",
        "title": {
          "en": "Mitigation cleared",
          "no": "Tiltak opphevet"
        },
        "tokens": [
          {
            "name": "device_name",
            "type": "string",
            "title": {
              "en": "Device name",
              "no": "Enhetsnavn"
            },
            "example": "Floor heater"
          }
        ]
      },
      {
        "id": "profile_changed",
        "title": {
          "en": "Active profile changed",
          "no": "Aktiv profil endret"
        },
        "tokens": [
          {
            "name": "profile",
            "type": "string",
            "title": {
              "en": "Profile",
              "no": "Profil"
            },
            "example": "strict"
          }
        ]
      }
    ],
    "conditions": [
      {
        "id": "guard_enabled",
        "title": {
          "en": "Power Guard is enabled",
          "no": "Power Guard er aktivert"
        }
      },
      {
        "id": "is_over_limit",
        "title": {
          "en": "Power is over limit",
          "no": "Effekten er over grensen"
        }
      },
      {
        "id": "profile_is",
        "title": {
          "en": "Active profile is",
          "no": "Aktiv profil er"
        },
        "args": [
          {
            "name": "profile",
            "type": "dropdown",
            "title": {
              "en": "Profile",
              "no": "Profil"
            },
            "values": [
              {
                "id": "normal",
                "label": {
                  "en": "Normal",
                  "no": "Normal"
                }
              },
              {
                "id": "strict",
                "label": {
                  "en": "Strict (90% limit)",
                  "no": "Streng (90% grense)"
                }
              },
              {
                "id": "solar",
                "label": {
                  "en": "Solar-friendly",
                  "no": "Sol-vennlig"
                }
              }
            ]
          }
        ]
      }
    ],
    "actions": [
      {
        "id": "enable_guard",
        "title": {
          "en": "Enable Power Guard",
          "no": "Aktiver Power Guard"
        }
      },
      {
        "id": "disable_guard",
        "title": {
          "en": "Disable Power Guard",
          "no": "Deaktiver Power Guard"
        }
      },
      {
        "id": "set_profile",
        "title": {
          "en": "Set active profile",
          "no": "Sett aktiv profil"
        },
        "args": [
          {
            "name": "profile",
            "type": "dropdown",
            "title": {
              "en": "Profile",
              "no": "Profil"
            },
            "values": [
              {
                "id": "normal",
                "label": {
                  "en": "Normal",
                  "no": "Normal"
                }
              },
              {
                "id": "strict",
                "label": {
                  "en": "Strict (90% limit)",
                  "no": "Streng (90% grense)"
                }
              },
              {
                "id": "solar",
                "label": {
                  "en": "Solar-friendly",
                  "no": "Sol-vennlig"
                }
              }
            ]
          }
        ]
      },
      {
        "id": "reset_statistics",
        "title": {
          "en": "Reset statistics",
          "no": "Tilbakestill statistikk"
        }
      }
    ]
  }
}